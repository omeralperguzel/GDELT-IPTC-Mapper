<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>GDELT K√ºmeleme - Basit Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 1200px; margin: 0 auto; }
        button { padding: 10px 20px; margin: 5px; font-size: 14px; cursor: pointer; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
        .cluster { border: 1px solid #ccc; padding: 15px; margin: 10px 0; border-radius: 5px; }
        h2 { color: #667eea; }
    </style>
</head>
<body>
    <h1>üéØ GDELT Tema K√ºmelemesi</h1>
    
    <div>
        <button onclick="testJSON()">Test 1: JSON Valid mi?</button>
        <button onclick="displayClusters()">Test 2: K√ºmeleri G√∂ster</button>
        <button onclick="displayAllThemes()">Test 3: T√ºm Temalarƒ± G√∂ster</button>
        <button onclick="clearAll()">Temizle</button>
    </div>
    
    <div id="output"></div>

    <script>
        let clusterData = null;

        async function loadJSON() {
            try {
                const resp = await fetch('gdelt_theme_clusters.json');
                clusterData = await resp.json();
                return clusterData;
            } catch (e) {
                document.getElementById('output').innerHTML = `<p class="error">‚ùå JSON y√ºklenemedi: ${e.message}</p>`;
                return null;
            }
        }

        async function testJSON() {
            document.getElementById('output').innerHTML = '<p class="info">‚è≥ Test yapƒ±lƒ±yor...</p>';
            const data = await loadJSON();
            
            if (!data) return;
            
            let html = '<div class="success"><h2>‚úÖ JSON Ba≈üarƒ±yla Y√ºklendi!</h2>';
            html += `<p><strong>Model:</strong> ${data.metadata.model}</p>`;
            html += `<p><strong>K√ºmeler:</strong> ${data.metadata.n_clusters}</p>`;
            html += `<p><strong>Temalar:</strong> ${data.metadata.total_themes}</p>`;
            html += `<p><strong>Algoritma:</strong> ${data.metadata.algorithm}</p>`;
            html += `</div>`;
            
            document.getElementById('output').innerHTML = html;
        }

        async function displayClusters() {
            if (!clusterData) await loadJSON();
            if (!clusterData) return;

            let html = '<h2>üìä K√ºmeler</h2>';
            for (const [id, cluster] of Object.entries(clusterData.cluster_labels)) {
                const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#FFA502', '#95E1D3', '#C87094', '#6C5CE7', '#00B894'];
                const bgColor = colors[id % colors.length];
                
                html += `<div class="cluster" style="border-left: 5px solid ${bgColor};">`;
                html += `<h3>K√ºme ${id}: ${cluster.iptc_label}</h3>`;
                html += `<p><strong>IPTC:</strong> ${cluster.iptc_description}</p>`;
                html += `<p><strong>Dominant Issue:</strong> ${cluster.dominant_issue}</p>`;
                html += `<p><strong>Tema Sayƒ±sƒ±:</strong> ${cluster.theme_count}</p>`;
                html += `<p><strong>√ñrnek Temalar:</strong> ${cluster.sample_themes.join(', ')}</p>`;
                html += `</div>`;
            }
            document.getElementById('output').innerHTML = html;
        }

        async function displayAllThemes() {
            if (!clusterData) await loadJSON();
            if (!clusterData) return;

            let html = '<h2>üìã T√ºm Temalar</h2>';
            html += '<table border="1" cellpadding="8" style="width: 100%; border-collapse: collapse;">';
            html += '<tr><th>Tema Kodu</th><th>K√ºme</th><th>Konu Kategorisi</th></tr>';
            
            for (const theme of clusterData.themes) {
                html += `<tr>
                    <td><strong>${theme.theme_code}</strong></td>
                    <td>${theme.cluster}</td>
                    <td>${theme.issue_category || '-'}</td>
                </tr>`;
            }
            html += '</table>';
            
            document.getElementById('output').innerHTML = html;
        }

        function clearAll() {
            document.getElementById('output').innerHTML = '';
            clusterData = null;
        }

        // Sayfa y√ºklendiƒüinde otomatik test
        window.addEventListener('load', () => {
            testJSON();
        });
    </script>
</body>
</html>
